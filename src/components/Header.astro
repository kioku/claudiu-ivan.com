---
import Container from "@components/Container.astro";
import Link from "@components/Link.astro";

type Props = {
  articleTitle?: string;
};

const { articleTitle } = Astro.props;
---

<header>
  <Container>
    <div class={`flex flex-wrap gap-y-2 ${articleTitle ? "justify-between items-center" : "justify-end"}`}>
      {articleTitle && (
        <div id="article-title" class="text-sm font-medium text-black dark:text-white transition-opacity duration-300" style="opacity: 0">
          {articleTitle}
        </div>
      )}
      <nav class="flex gap-1">
        <Link href="/">Home</Link>
        <span>&nbsp;</span>
        <Link href="/writing">Writing</Link>
      </nav>
    </div>
  </Container>
</header>

<script>
  function handleScroll() {
    const articleTitleDiv = document.getElementById("article-title");
    if (!articleTitleDiv) {
      return;
    }

    if (window.scrollY > 200) {
      articleTitleDiv.style.opacity = "1";
    } else {
      articleTitleDiv.style.opacity = "0";
    }
  }

  function initializeScrollHandler() {
    // Reset scroll position to top on new page navigation
    window.scrollTo(0, 0);

    // Initialize the scroll handler
    handleScroll();

    // Add scroll listener
    window.addEventListener("scroll", handleScroll);
  }

  // Initialize on initial page load
  document.addEventListener("DOMContentLoaded", initializeScrollHandler);

  // Re-initialize on view transitions
  document.addEventListener("astro:page-load", initializeScrollHandler);

  // Cleanup on navigation
  document.addEventListener("astro:before-preparation", () => {
    window.removeEventListener("scroll", handleScroll);
  });
</script>
